!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4a505fac-b197-4b6c-94da-7a6386cbf53f",e._sentryDebugIdIdentifier="sentry-dbid-4a505fac-b197-4b6c-94da-7a6386cbf53f")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2857],{61148:function(e,t,a){a.d(t,{Z:function(){return d}});var i=a(2265),n=a(10541);function d(e){let{postMessage:t,forceMetadata:a}=e,{setUserId:d,setMetadata:s,setTrack:o,setUserIdAuth:r,anonymizeUserId:l,metadataRequest:c,setMetadataRequest:u,addMetadata:v,setQuestion:g,setLocalizationData:p,setIsConversationUrlVisible:m,setConversationId:h,setChatSessionDuration:f,setStartNewConversation:E,addMetadataRequestKey:w,clearMetadataRequestKeys:b,setWidgetCornerPosition:x,setMobile:I,conversationId:M,addSdkMessage:y}=(0,n.K)(e=>({setUserId:e.setUserId,anonymizeUserId:e.anonymizeUserId,setMetadata:e.setMetadata,setTrack:e.setTrack,setUserIdAuth:e.setUserIdAuth,metadataRequest:e.metadataRequest,setMetadataRequest:e.setMetadataRequest,addMetadata:e.addMetadata,setQuestion:e.setQuestion,setLocalizationData:e.setLocalizationData,setIsConversationUrlVisible:e.setIsConversationUrlVisible,setConversationId:e.setConversationId,setChatSessionDuration:e.setChatSessionDuration,setStartNewConversation:e.setStartNewConversation,addMetadataRequestKey:e.addMetadataRequestKey,clearMetadataRequestKeys:e.clearMetadataRequestKeys,setWidgetCornerPosition:e.setWidgetCornerPosition,setMobile:e.setMobile,conversationId:e.conversationId,addSdkMessage:e.addSdkMessage})),C=(0,i.useRef)(c);return(0,i.useEffect)(()=>{C.current=c,"loading"==c.status&&t({type:"REQUEST_METADATA",payload:{subtype:c.subtype,params:c.params}},"*")},[c]),(0,i.useEffect)(()=>{M&&b()},[M]),(0,i.useEffect)(()=>{o(e=>{t({type:"USER_ACTION",payload:e},"*")}),window.addEventListener("message",e=>{var i,n,o,c,b,M,N,R,A,D,_,S,T,U,k,O,j,P,H,W,V,q,z,G,L,K,Z;if(null===(i=e.data)||void 0===i?void 0:i.coord){let a=e.data.coord;if(!a.x||!a.y)return;let i=document.getElementById("duet-widget"),n=document.elementFromPoint(a.x,a.y);n&&i&&i.contains(n)?t({type:"DECAGON_HOVER"},"*"):t({type:"DECAGON_UNHOVER"},"*")}else if(null===(n=e.data)||void 0===n?void 0:n.metadata)s({...e.data.metadata,...null!=a?a:{}});else if(null===(o=e.data)||void 0===o?void 0:o.addMetadata)v(e.data.addMetadata);else if(null===(c=e.data)||void 0===c?void 0:c.userId)d(e.data.userId);else if((null===(b=e.data)||void 0===b?void 0:b.initialUserMessage)!==void 0)g(e.data.initialUserMessage);else if((null===(M=e.data)||void 0===M?void 0:M.userIdAuth)!==void 0)r(e.data.userIdAuth.signature,e.data.userIdAuth.epoch);else if((null===(N=e.data)||void 0===N?void 0:N.anonymizeUserId)!==void 0)l();else if((null===(R=e.data)||void 0===R?void 0:R.metadataRequestResult)!==void 0){let t=C.current,a=t.subtype,i=e.data.metadataRequestResult,n="user_".concat(a);if(i.ok){let e=i.data[a],d=null!==(W=i.data.persist)&&void 0!==W&&W,s=null!==(V=i.data.persistenceLevel)&&void 0!==V?V:"PERMANENT";v({[n]:e,decagon_redacted_fields:d&&"PERMANENT"===s?[]:[n]}),u({...t,status:"success",persist:d,persistenceLevel:d?s:void 0}),d&&"PERMANENT"!==s&&w(n)}else v({["user_".concat(a,"_error")]:i.error}),u({...t,status:"error"})}else(null===(A=e.data)||void 0===A?void 0:A.triggerMessage)?(v({triggerMessage:null===(q=e.data)||void 0===q?void 0:q.triggerMessage}),(null===(z=e.data)||void 0===z?void 0:z.isProactive)&&v({proactiveMessage:null===(G=e.data)||void 0===G?void 0:G.triggerMessage})):(null===(D=e.data)||void 0===D?void 0:D.proactiveMessage)?v({proactiveMessage:null===(L=e.data)||void 0===L?void 0:L.proactiveMessage}):(null===(_=e.data)||void 0===_?void 0:_.localizationData)?p(e.data.localizationData):(null===(S=e.data)||void 0===S?void 0:S.isConversationUrlVisible)!==void 0?m(e.data.isConversationUrlVisible):(null===(T=e.data)||void 0===T?void 0:T.chatSessionDuration)!==void 0?f(e.data.chatSessionDuration):(null===(U=e.data)||void 0===U?void 0:U.startNewConversation)!==void 0?E(e.data.startNewConversation):(null===(k=e.data)||void 0===k?void 0:k.conversationId)!==void 0?h(null===(K=e.data)||void 0===K?void 0:K.conversationId):(null===(O=e.data)||void 0===O?void 0:O.widgetCornerPosition)!==void 0?x(e.data.widgetCornerPosition):(null===(j=e.data)||void 0===j?void 0:j.isMobile)!==void 0?I(e.data.isMobile):(null===(P=e.data)||void 0===P?void 0:P.sdkMessage)!==void 0?y(String(e.data.sdkMessage)):(null===(H=e.data)||void 0===H?void 0:H.theme)!==void 0&&document.documentElement.setAttribute("data-appearance",null===(Z=e.data.theme)||void 0===Z?void 0:Z.appearance)}),t({type:"DECAGON_LOADED"},"*")},[]),null}},32857:function(e,t,a){a.r(t),a.d(t,{EmbeddableWidget:function(){return b},default:function(){return p}});var i=a(57437),n=a(2265),d=a(91434),s=a(33145),o=a(10541),r=a(81230),l=a(80502),c=a(61340),u=a(79067),v=a(50510);function g(e){var t,a,g;let{theme:p,closedWidth:m,closedHeight:h,setMinimized:f,namespace:E,widgetSettings:w}=e,b=(0,n.useRef)(!0),x=(0,n.useRef)(!1),I={width:null!=m?m:"large"===p?190:66,height:null!=h?h:"large"===p?54:66,borderRadius:(null==w?void 0:w.squareChatIcon)?12:33},[M,y]=(0,n.useState)({width:void 0,height:void 0}),[C,N]=(0,d.q_)(()=>I),{isExpanded:R,setExpanded:A,track:D,localizationData:_,setIsExpandAnimating:S,setSurveyOpen:T,isMobile:U}=(0,o.K)(e=>({isExpanded:e.isExpanded,setExpanded:e.setExpanded,track:e.track,localizationData:e.localizationData,setIsExpandAnimating:e.setIsExpandAnimating,setSurveyOpen:e.setSurveyOpen,isMobile:e.isMobile}));return((0,n.useEffect)(()=>{function e(){y({width:window.innerWidth,height:window.innerHeight})}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,n.useLayoutEffect)(()=>{var e;if(b.current&&(b.current=!1,!R))return;let t=r.$7,a=null!==(e=null==w?void 0:w.openHeight)&&void 0!==e?e:r.R$,i={width:U?window.innerWidth:Math.min(window.innerWidth-40,t),height:U?window.innerHeight:Math.min(window.innerHeight-40,a),borderRadius:"ramp"===E||U?0:12},n=C.width.get(),d=C.height.get();R||I.width==n||I.height==d?R&&i.width!=n&&i.height!=d&&(N.start({from:I,to:i,config:{mass:1,friction:33,tension:500},onStart:()=>{S(!0)},onRest:()=>{S(!1)}}),x.current||(D({eventName:"DUET_INITIALIZE"}),x.current=!0)):(N.start({to:I,from:i,config:{mass:1,friction:33,tension:400},onStart:()=>{S(!0)},onRest:()=>{S(!1)}}),x.current&&(D({eventName:"DUET_DEINITIALIZE"}),x.current=!1))},[R,R?M:null]),R)?(0,i.jsx)(d.q.div,{className:"flex flex-col overflow-hidden bg-white team-theme-widget relative ".concat(U?"":"mr-5 mb-5 all-shadow"),style:{...C},role:"dialog","aria-label":"Chat interface","aria-modal":"true",tabIndex:0,children:(0,i.jsx)(u.Z,{onClose:e=>{A(!1),T(!1),f&&f(!!e)}})},"widget"):(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(d.q.div,{className:"mr-5 mb-5 overflow-hidden max-h-screen rounded-full flex items-center justify-center shadow-lg cursor-pointer hover:scale-110 team-theme-widget widget-closed team-theme-bg ".concat("substack"===E&&U?"origin-bottom-right scale-75":""),onClick:()=>{A(!0)},style:{transition:"transform .3s",...C},onKeyDown:e=>("Enter"===e.code||"Space"===e.code)&&A(!0),tabIndex:1,role:"button","aria-label":"Open Chat Agent","aria-expanded":"false",children:"large"===p?(0,i.jsxs)("div",{className:"".concat(["360_payments_capital","marriott"].includes(E)?"text-black":"text-white"," font-semibold flex items-center"),"aria-label":(null==_?void 0:_.widgetText)||(null==w?void 0:w.defaultText)||"Ask a question",children:[(null==w?void 0:w.chatIconUrl)?(0,i.jsx)(s.default,{src:(0,v.np)(w.chatIconUrl),alt:"".concat(E," chat icon"),height:28,width:28,className:"mr-2.5","aria-hidden":"true",unoptimized:!0}):(0,i.jsx)(c.Z,{className:"mr-2.5","aria-hidden":"true"}),(null==_?void 0:_.widgetText)||(null==w?void 0:w.defaultText)||"Ask a question"]}):"small"===p?(0,i.jsx)("div",{className:"text-white font-semibold text-3xl","aria-label":"Chat message icon",children:(0,i.jsx)(c.Z,{"aria-hidden":"true"})}):(0,i.jsx)("div",{className:null!==(t=null==w?void 0:w.padding)&&void 0!==t?t:"",children:(0,i.jsx)(s.default,{src:(null==w?void 0:w.chatIconUrl)?(0,v.np)(w.chatIconUrl):(0,v.np)("/avatars/".concat((0,l.IA)(E),".png")),alt:"".concat(E," chat avatar"),height:null!==(a=null==w?void 0:w.defaultChatIconHeight)&&void 0!==a?a:42,width:null!==(g=null==w?void 0:w.defaultChatIconWidth)&&void 0!==g?g:42,quality:88,className:"widget-avatar","aria-hidden":"true",unoptimized:!0})})},"widget")})}function p(e){var t,a,d,s,r;let{setNamespace:c,setTeamId:u,namespace:p,widgetPreferences:m,setWidgetPreferences:h,isMobile:f,setMobile:E,widgetTheme:w}=(0,o.K)(e=>({setNamespace:e.setNamespace,setTeamId:e.setTeamId,namespace:e.namespace,widgetPreferences:e.widgetPreferences,setWidgetPreferences:e.setWidgetPreferences,isMobile:e.isMobile,setMobile:e.setMobile,widgetTheme:e.widgetTheme})),b=p||e.namespace;(0,n.useEffect)(()=>{(0,v.LE)((0,l.IA)(p),"BASE",w).then(e=>{"error"in e||h(e)})},[p,w]),(0,n.useEffect)(()=>{c(e.namespace),u(e.teamId);let t=navigator.userAgent||navigator.vendor;(/android/i.test(t)||/iPad|iPhone|iPod/.test(t))&&E(!0)},[e.namespace,e.teamId]);let x="logo";return(m&&(x=(null===(d=m.settings)||void 0===d?void 0:d.theme)==="dynamic"?f?"small":"large":null!==(r=null===(s=m.settings)||void 0===s?void 0:s.theme)&&void 0!==r?r:"logo"),m)?(0,i.jsx)(g,{theme:x,closedWidth:null==m?void 0:null===(t=m.settings)||void 0===t?void 0:t.closedWidth,closedHeight:null==m?void 0:null===(a=m.settings)||void 0===a?void 0:a.closedHeight,setMinimized:e.setMinimized,namespace:b,widgetSettings:null==m?void 0:m.settings},"".concat(x,"-").concat(b)):null}var m=a(49638);function h(e){let{metadata:t,hasBeenExpanded:a,setExpanded:d,track:s}=(0,o.K)(e=>({metadata:e.metadata,hasBeenExpanded:e.hasBeenExpanded,setExpanded:e.setExpanded,track:e.track})),[r,l]=(0,n.useState)(!0),c=(0,n.useRef)(null),u=!!t&&!!t.proactiveMessage,v=!e.isWidgetHidden&&r&&!a&&u;return(0,n.useEffect)(()=>{if(c.current&&v){let t=c.current.clientHeight+parseInt(window.getComputedStyle(c.current).marginTop)+parseInt(window.getComputedStyle(c.current).marginBottom),a=c.current.clientWidth+parseInt(window.getComputedStyle(c.current).marginLeft)+parseInt(window.getComputedStyle(c.current).marginRight);parent.postMessage({type:"DECAGON_PROACTIVE_MESSAGE",action:"open",isHidden:e.isWidgetHidden,proactiveMessageHeight:t,proactiveMessageWidth:a},"*")}else parent.postMessage({type:"DECAGON_PROACTIVE_MESSAGE",isHidden:e.isWidgetHidden,action:"close"},"*")},[v,e.isWidgetHidden]),(0,i.jsx)(i.Fragment,{children:v&&r&&(0,i.jsx)("div",{ref:c,className:"absolute bottom-full my-4 mx-5 text-slate-700 ".concat("bottom-left"===e.cornerPosition?"left-0":"right-0"),style:{width:"max-content",maxWidth:300},children:(0,i.jsxs)("div",{id:"proactive-message-bubble",className:"bg-slate-200 widget-agent-chat-bubble rounded-lg relative group",style:{width:"max-content",maxWidth:300},children:[(0,i.jsx)("div",{className:"absolute top-0 right-0 mt-[-12px] mr-[-12px] transition-opacity duration-300 opacity-0 group-hover:opacity-100 cursor-pointer bg-opacity-10 hover:bg-opacity-20 bg-black flex justify-center items-center w-8 h-8 rounded-full",onClick:()=>{l(!1),s({eventName:"DUET_USER_DISMISSED_PROACTIVE"})},role:"button","aria-label":"Close",children:(0,i.jsx)(m.Z,{className:"text-white"})}),(0,i.jsx)("div",{className:"break-words py-4 px-5 whitespace-pre-wrap cursor-pointer",onClick:()=>d(!0),children:null==t?void 0:t.proactiveMessage})]})})})}var f=a(81770),E=a(61994),w=a(61148);function b(e){var t;let[a,d]=(0,n.useState)(null!==(t=e.hiddenMode)&&void 0!==t&&t),[s,r]=(0,n.useState)(!1),{isExpanded:l,setExpanded:c,track:u,widgetCornerPosition:v,setWidgetCornerPosition:g}=(0,o.K)(e=>({isExpanded:e.isExpanded,setExpanded:e.setExpanded,track:e.track,widgetCornerPosition:e.widgetCornerPosition,setWidgetCornerPosition:e.setWidgetCornerPosition})),m=null!=v?v:"bottom-right",b=a&&!s&&!l;return(0,n.useEffect)(()=>{window.addEventListener("message",e=>{var t,a,i;(null===(t=e.data)||void 0===t?void 0:t.isVisible)!==void 0?(c(!!e.data.isVisible),r(!1)):(null===(a=e.data)||void 0===a?void 0:a.hiddenMode)!==void 0?d(!!e.data.hiddenMode):(null===(i=e.data)||void 0===i?void 0:i.widgetCornerPosition)!==void 0&&g(e.data.widgetCornerPosition)})},[]),(0,n.useEffect)(()=>{l?(r(!1),parent.postMessage({type:"DECAGON_ACTIVE"},"*"),parent.postMessage({type:"DECAGON_HOVER"},"*")):(parent.postMessage({type:"DECAGON_INACTIVE",isHidden:b},"*"),parent.postMessage({type:"DECAGON_UNHOVER"},"*"))},[l,b]),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)(w.Z,{postMessage:(e,t)=>parent.postMessage(e,t)}),e.buildModeSettings&&(0,i.jsx)("div",{className:(0,E.Z)("absolute bottom-[20px] right-[450px] w-96 z-50 transition-all duration-300",l?"opacity-100 translate-x-0 translate-y-0":"opacity-0 translate-x-4 translate-y-4 hidden"),children:e.buildModeSettings}),(0,i.jsxs)("div",{className:"absolute bottom-0 ".concat("bottom-left"===m?"left-0 pl-5":"right-0"," z-50"),id:"duet-widget",onMouseEnter:()=>{parent.postMessage({type:"DECAGON_HOVER"},"*")},onMouseLeave:()=>{parent.postMessage({type:"DECAGON_UNHOVER"},"*")},onMouseOver:()=>{parent.postMessage({type:"DECAGON_HOVER"},"*")},style:{display:b?"none":"block"},children:[(0,i.jsx)(h,{cornerPosition:m,isWidgetHidden:b}),e.isHideable&&!l&&a&&(0,i.jsx)(f.Z,{onClick:()=>{r(!1),u({eventName:"DUET_WIDGET_HIDE"})},className:"absolute hover:scale-110 opacity-50",style:{left:"-12px",transition:"transform .3s"}}),(0,i.jsx)(p,{namespace:e.namespace,teamId:e.teamId,setMinimized:r})]})]})}},81230:function(e,t,a){var i,n;a.d(t,{$7:function(){return d},R$:function(){return s},gX:function(){return i}}),(n=i||(i={})).UNASSIGNED="Unassigned",n.REVIEW_REQUIRED="ReviewRequired",n.FIX_NEEDED="FixNeeded",n.RESOLVED="Resolved";let d=420,s=640}}]);