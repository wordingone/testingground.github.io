console.log("[import] git: 2dfc0f2b537fe1db070cae558afbb717c5d6973b, stamp: 7359B12110A75C82");
!function(){let e,t=e=>{};function r(t){e=t}function n(e){t=e}function o(e){t(e)}let s=!1;function i(){console.log("cancelConversion"),s=!0,g&&(g.terminate(),g=null),u&&(u=null);for(let e in m){let t=m[e];delete m[e],t.reject(new Error("Canceled import."))}}function a(){return s}function l(){s=!1}function c(e,t){let r=Array.prototype.forEach;function n(e,r){a()||t(r,e)}if(l(),e.items){let t=!1;if(r.call(e.items,(e=>{if(e.webkitGetAsEntry){let r=e.webkitGetAsEntry();if(r){let e=r.name;r.isDirectory?r.getFile("Data",null,(t=>t.file((t=>n(t,e))))):r.isFile&&r.file((t=>n(t,e))),t=!0}}})),t)return}r.call(e.files,(e=>n(e,e.name)))}let u=null,f=!0;function d(){f=!1}function p(){if(!u){let t=e||"import.worker.js",r=e=>{try{g=new Worker(e)}catch(e){throw u=null,new Error("Failed to load the web worker. Please contact Figma for support.")}return g.onmessage=b,g};u=f?function(e,t){return new Promise(((r,n)=>{let o=new XMLHttpRequest;o.onload=()=>{o.status>=200&&o.status<400&&r(o.response)},o.onloadend=()=>{n(new Error("Failed to download the file importer. Please make sure you're connected to the internet and try again."))},o.open("GET",e),o.responseType=t,o.send(null)}))}(t,"blob").then((e=>r(URL.createObjectURL(e)))):new Promise(((e,n)=>{e(r(t))}))}return u}let g=null,m={},w=0;function b(e){let r=e.data;switch(r.type){case"ConversionFailureResponse":{let e=r;if(e.id in m){let t=m[e.id];delete m[e.id];let r=e.error;r.inferredFormat=e.inferredFormat,r.warnings=e.warnings,r.reportError=e.reportError,e.originalError&&(r.cause=e.originalError),t.reject(r)}break}case"ConversionSuccessResponse":{let e=r;if(e.id in m){let r=m[e.id];delete m[e.id],a()?(t(100),r.reject(new Error("Import canceled"))):(t(20),r.resolve(e.result))}break}case"UpdateProgressMessage":t&&t(r.percentage);break;case"LoadFontMessage":{let t=r,n=m[t.id];(n&&n.fontLoader?n.fontLoader.getFont(t.postscript):Promise.reject(null)).then((r=>{let n={type:"FontLoadedMessage",id:t.id,postscript:t.postscript,result:r};e.target.postMessage(n,[r.font.buffer])})).catch((()=>{let r={type:"FontLoadedMessage",id:t.id,postscript:t.postscript,result:null};e.target.postMessage(r)}));break}default:console.warn("import shim got unsupported message: "+r.type)}}function F(e,t){if(e.length<t.length)return!1;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return!1;return!0}function y(e){return p().then((t=>new Promise(((r,n)=>{let o=e.message.id;m[o]={resolve:r,reject:n,fontLoader:e.fontLoader},t.postMessage(e.message,e.buffers)}))))}async function h({blob:e,featureFlags:t,fontLoader:r,isUserFigmaEmployee:n,fileExtension:o}){const s={...t};if(!a()){const t=new Uint8Array(await e.slice(0,20).arrayBuffer());if(E(t)||k(t)){let t=URL.createObjectURL(e);const n=new Image,o=new Promise(((e,t)=>{n.onerror=()=>{t({message:"Invalid image",stack:(new Error).stack})},n.onload=e}));n.src=t,await o;const i=new Uint8Array(await e.arrayBuffer()),a={type:"ImageConversionRequest",id:w++,bytes:i,width:n.width,height:n.height,featureFlags:s};return await y({message:a,buffers:[i.buffer],fontLoader:r})}const i={type:"FileConversionRequest",id:w++,blob:e,featureFlags:s,isUserFigmaEmployee:n,fileExtension:o};return await y({message:i,buffers:[],fontLoader:r})}return{file:null,videos:[],images:[],warnings:[]}}function E(e){return F(e,[137,80,78,71,13,10,26,10])}function k(e){return F(e,[255,216])}function L(e){return F(e,[71,73,70,56,55,97])||F(e,[71,73,70,56,57,97])}window.createFileImporter=e=>(delete window.createFileImporter,r(e),{convertFile:h,disableWorkerBlob:d,cancelConversion:i,hasCanceled:a,resetCancel:l,setUpdateProgressCallback:n,callUpdateProgressCallback:o,extractFilesFromDropEvent:c,isProbablyJPEGFile:k,isProbablyPNGFile:E,isProbablyGIFFile:L})}();
